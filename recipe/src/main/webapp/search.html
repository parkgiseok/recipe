<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>냉장고를 가져와</title>
<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
<link rel="stylesheet" media="all" href="css/search.css" />
<link rel="stylesheet" href="css/font.css">

<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="bower_components/handlebars/handlebars.min.js"></script>
</head>

<body>  
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#defaultNavbar1"> 
          <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img id="titleimg" src="img/title.PNG"/></a>
      </div>
      <div class="collapse navbar-collapse" id="defaultNavbar1">
        <form class="navbar-form navbar-left" role="search">
          <div class="form-group"><input type="text" value="" class="form-control" id="searchvalue" placeholder="예) 김치 볶음밥"></div>
          <a onclick='javascript:fncSubmit();' class="btn btn-default">검색</a>          
        </form>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="#">로그아웃</a></li>
          <li><a href="myPage.html">마이페이지</a></li>
        </ul>
      </div>
    </div>
  </nav>
  
  <script>
  var searchValue;        
  $('input').keyup(function() {
    searchValue = encodeURIComponent($(this).val());
  });        
  function fncSubmit() {
    console.log("encoded searchValue: " + searchValue);
//    searchValue = decodeURI(searchValue);
//    console.log("decoded searchValue: " + searchValue);
    location.href = 'search.html?value=' + searchValue;
  }
  </script>
        
  <div class="container">
    <section class="sec_main_recipe">
      <div>
        <div>
          <p class="search_tag"> 
          </p>
        </div>
        <hr>
        <dl class="inner">
          <dt>닉네임으로 검색된 결과<br><br></dt>
          <dd></dd>
          <dd>
            <ol class="lst_recipe" id="list1"></ol>
          </dd>
        </dl>
        <hr>
        <dl class="inner">
          <dt>제목으로 검색된 결과<br><br></dt>
          <dd></dd>
          <dd>
            <ol class="lst_recipe" id="list2"></ol>
          </dd>
        </dl>
        <hr>
        <dl class="inner">
          <dt>음식태그로 검색된 결과<br><br></dt>
          <dd></dd>
          <dd>
            <ol class="lst_recipe" id="list3"></ol>
          </dd>
        </dl>
      </div>
      <hr>
    </section>
  <footer>
    <div class="text-center col-xs-6 col-xs-offset-3">
      <p>
        Copyright &copy; 2016 &middot; All Rights Reserved &middot; <a
          href="http://127.0.0.1:8080/index.html">냉장고를 가져와</a>
      </p>
    </div>
  </footer>
  </div>
  
  <script>
  var Request = function() {
    this.getParameter = function(name) {
      var rtnval = '';
      var nowAddress = location.href;
      var parameters = (nowAddress.slice(nowAddress.indexOf('?')+1,nowAddress.length)).split('&');
      for(var i = 0 ; i < parameters.length ; i++) {
        var varName = parameters[i].split('=')[0];
        if(varName.toUpperCase() == name.toUpperCase()) {
          rtnval = parameters[i].split('=')[1];
          console.log('===>', rtnval);
          break;
        }
      }
      return rtnval;
    }
  }
  var request = new Request();
  </script>
  
  <script id="card" type="text/x-handlebars-template">
  {{#each list}}
  <li class="cardlist" id="a{{@index}}">
    <input id="bno{{@index}}" type="hidden" value="19"/>
    <div id="f1_container">
      <div id="f1_card">
        <div class="card front face" id="card{{@index}}">
          <div class="thmb"> <img src="{{m_photo}}"/> </div> 
          <span class="author"> 
            <img src="{{photo}}"/>
            <strong>{{nick}}</strong> 
          </span>
          <div class="title"><p>{{title}}</p></div>          
        </div>
        <div class="back face center">
          <div class="back_card">
            <div class="m_cate_border">{{category}}
              <p class="m_cate">주카테고리</p>
            </div>
            <div class="m_cate_border2">{{desct}}
              <p class="intro">자기소개</p>
            </div><hr>
            <div class="last_recipe">
              <img src="img/last.png" class="last_img" style="width:120px;"/>
            </div>
            <div class="row">
              <div class="col-xs-3 col-xs-3">
                <img src="img/2.jpg" class="last_img2" style="width:50px;"/>
              </div>
              <div class="last_recipe_text col-xs-9 col-xs-9">
                <span>  </span>
              </div>
            </div>
            <div class="most_recipe">
              <img src="img/most.png" class="most_img" style="width:120px;"/>
            </div>
            <div class="row">
              <div class="col-xs-3 col-xs-3">
                <img src="img/3.jpg" class="most_img2" style="width:50px;"/>
              </div>
              <div class="most_recipe_text col-xs-9 col-xs-9">
                <span> 내가 제일 잘 나가ㅏㅏㅏㅏ...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="option">
        <div class="time"><button>{{time}}분</button></div>
        <div class="like"><button type="submit">{{like}}명</button></div>
        <div class="share"><button>공유하기</button></div>
      </div>
    </div>

    <div class="desc">
      <script>
        var level = {{level}};
        var levelStar;
        if(level <= 2) levelStar = "img/1star.png";
        else if(level <= 4) levelStar = "img/2star.png";
        else if(level <= 6) levelStar = "img/3star.png";
        else if(level <= 8) levelStar = "img/4star.png";
        else if(level <= 10) levelStar = "img/5star.png";
        $("#star{{@index}}").attr("src", levelStar);
      <{{!}}/script>
      
      <div class="level">난이도 : <img id="star{{@index}}" src="" style="width:40%; margin-top:-2px;"> </div>
      <div class="intro2"> {{cont}} </div>
      <div class="ingre" id="ingre{{@index}}">{{tname}}</div>
      <div class="date">{{w_dt}}</div>
      <div class="option2">
        <div class="site"><a href="urlPage.html">간단히 보기</a></div>
        <div class="blog"><a href="urlPage.html">자세히 보기</a></div>
      </div>
    </div>
  </li>
  {{/each}}
  </script>
  
  <script>
  var value = request.getParameter('value');
  console.log("received(encoded) value: " + value);
  value = decodeURIComponent(value);
  console.log("decoded value: " + value);
  
  $(document).ready(function() {
    $.post("./ajax/recipe/searchRecipeByNick.do", {
      nick : value
    }, function(result) {
      var template = Handlebars.compile($('#card').html());
      $("#list1").append(template(result));
    }, "json");
  });
  
  $(document).ready(function() {    
    $.post("./ajax/recipe/searchRecipeByTitle.do", {
      title : value
    }, function(result) {
      var template = Handlebars.compile($('#card').html());
      $("#list2").append(template(result));
    }, "json");
  });
  
  $(document).ready(function() {    
    $.post("./ajax/recipe/searchRecipeByTag.do", {
      tag : value
    }, function(result) {
      var template = Handlebars.compile($('#card').html());
      $("#list3").append(template(result));
    }, "json");
  });
  </script>
  
  <script>
  var c = false;
  
  $(function() {
    $(".category1").css("color", "black").css("font-weight", "600");
  });
  
  $(".category1").click(function() {
    if (c == true) {
      $(".category1").css("color","black").css("font-weight", "600");
      $(".category2").css("color","gray").css("font-weight", "normal");
      c = false;
    };
  });
  
  $(".category2").click(function() {
    if (c == false) {
      $(".category2").css("color","black").css("font-weight", "600");
      $(".category1").css("color","gray").css("font-weight", "normal");
      c = true;
    };
  });
  </script>

</body>
</html>